{% extends 'gecoviz/base.html' %}
{% block content %}
{% load static %}

<div class="container-xxl mx-auto m-1">
    <div class="card col-12">
      <div class="card-header card-title mb-0 mt-2 f-bold">
          Searches
      </div>
      <div class="card-body d-flex flex-wrap m-3 mt-0">
          <div class="col-xl-6 pr-xl-4">
              In the <a href="/" target="_self">home page</a>, you can find two
              panels, that allow to either:
              <ul>
                  <li>Browse the KEGG Orthology hierarchy.</li>
                  <li>Enter a custom sequence. After mapping it to eggNOG
                      Orthologous Groups, you can visualize their genomic context.</li>
              </ul>
          </div>

          <div class="col-xl-6 pl-xl-4">
              On the other hand, explicit searches can be performed by using
              the <b class="f-bold color-indigo">search bar</b>
              on the website's navigation bar. Through the selector on
              the left, choose the category that matches the functional term of
              interest, which can be entered in the text input on the right.
              Functional terms may belong to the following categories:
              <ul>
                  <li>Gene / protein name.</li>
                  <li>Orthologous Groups (KEGG KOs, eggNOG OGs).</li>
                  <li>PFAM protein families.</li>
              </ul>
              
          </div>
      </div>
    </div>

    <div class="card col-12 mt-3">
      <div class="card-header card-title mb-0 mt-2 f-bold">
          Taxonomy selector
      </div>
      <div class="card-body d-flex justify-content-center">
          <img src="{% static "gecoviz/img/taxselector.png" %}"
               alt="Genomic context graph outline"
               class="mt-2"
               style="width:95%; height:auto; max-width:80rem"/>
      </div>
    </div>


    <div class="card col-12 mt-3">
      <div class="card-header mb-0 mt-2">
          <div class="card-title f-bold">
              Genomic context visualizer
          </div>
          <ul class="nav nav-tabs ml-5" id="gcv-tab" role="tablist"
              style="border-bottom:none">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="gcv-overview-tab" data-toggle="tab"
                    data-target="#gcv-overview" type="button" role="tab" 
                    aria-controls="gcv-overview" aria-selected="true">
                    Overview
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="gcv-controlpanel-tab" data-toggle="tab"
                    data-target="#gcv-controlpanel" type="button" role="tab" 
                    aria-controls="gcv-controlpanel" aria-selected="false">
                    Control panel
                </button>
              </li>
              {% comment %}<li class="nav-item" role="presentation">{% endcomment %}
                {% comment %}<button class="nav-link" id="contact-tab" data-toggle="tab"{% endcomment %}
                    {% comment %}data-target="#contact" type="button" role="tab" {% endcomment %}
                    {% comment %}aria-controls="contact" aria-selected="false">{% endcomment %}
                    {% comment %}Legend{% endcomment %}
                {% comment %}</button>{% endcomment %}
              {% comment %}</li>{% endcomment %}
          </ul>
      </div>
      <div class="card-body tab-content" id="gcv-tab-content">
          <div class="tab-pane fade show active"
              id="gcv-overview" role="tabpanel" aria-labelledby="gcv-overview-tab">
              <div class="d-flex justify-content-center">
                  <img src="{% static "gecoviz/img/context_vis.png" %}"
                       alt="Genomic context graph outline"
                       class="mt-2"
                       style="width:95%; height:auto; max-width:80rem"/>
              </div>
          </div>
          <div class="tab-pane fade" id="gcv-controlpanel" 
              role="tabpanel" aria-labelledby="gcv-control-tab">
              <div class="d-flex justify-content-center">
                  <img src="{% static "gecoviz/img/control_panel.png" %}"
                       alt="Genomic context control panel"
                       class="mt-2"
                       style="width:95%; height:auto; max-width:80rem"/>
              </div>
              <div class="row row-cols-xxl-5 row-cols-xl-3 row-cols-2 g-2">
                  <div class="col">
                      <div class="card no-box-shadow h-100">
                          <div class="card-header card-title">
                              1. Tree visualization
                          </div>
                          <div class="card-body">
                             The phylogenetic tree on the left of the graph
                             (see overview) can be modified in several ways.
                             Its width can be shrunk (for a more compact
                             visualization) and the branch length and support
                             can be shown or hidden at user's discretion.
                             Lastly, the text displayed on the leaves can me
                             modified. As every leaf node has a phylogeny
                             associated, the taxonomic level that is shown can
                             be selected (as seen in the picture above)
                          </div>
                      </div>
                  </div>
                  <div class="col">
                      <div class="card no-box-shadow h-100">
                          <div class="card-header card-title">
                              2. Isolation source
                          </div>
                          <div class="card-body">
                              Each genome may have an isolation source
                              associated. We can then filter genomes by their
                              isolation source, by switching on/off the checkboxes shown
                              in section 2 of the figure above.
                              <div class="text-muted">
                                  Note: genomes with unknown isolation source
                                  can be filtered out by switching off the
                                  "Unknown" checkbox
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="col">
                      <div class="card no-box-shadow h-100">
                          <div class="card-header card-title">
                              3. Genomic context
                          </div>
                          <div class="card-body">
                              The genomic context visualization (central panel
                              in graph. See overview) can be customized in
                              several ways:
                              <ul>
                                  <li>
                                      Gene size: gene length and distance can
                                      be scaled to depict genomic dimensions
                                  </li>
                                  <li>
                                      Height collapsing: gene height can be collapsed
                                      to fit a greater number of genomes in the
                                      screen. Although less detailed (text on
                                      leaves and genes will not be seen), this
                                      view can be particularly useful if we are
                                      studying a relatively elevated number of
                                      genomes.
                                  </li>
                                  <li>
                                      Number of genes in neighborhood: the
                                      number of genes upstream and downstream
                                      to the anchor/central gene can be
                                      modified independently. A maximum of 10
                                      genes can be visualized on each side.
                                  </li>
                                  <li>
                                      Text on gene: although the most common
                                      setting is to show their gene name, the
                                      text displayed on genes can be chosen.
                                  </li>
                              </ul>
                          </div>
                      </div>
                  </div>
                  <div class="col">
                      <div class="card no-box-shadow h-100">
                          <div class="card-header card-title">
                              3. Color by function
                          </div>
                          <div class="card-body">
                              Genes can be colored by different functional
                              annotations. This selector allows us to seemingly
                              transition from one to another, obtaining a more
                              comprehensive view of the gene-of-interest
                              neighborhood.
                              Among those functional terms, we can color genes
                              by:
                              <ul>
                                  <li>KEGG pathways</li>
                                  <li>KEGG Orthology</li>
                                  <li>EggNOG Orthology</li>
                                  <li>Pfam domains</li>
                              </ul>
                              Furthermore, hierarchical functional terms such as EggNOG
                              Orthology can be fine-grained using the selector
                              on the right (we can choose at which taxa the
                              orthology cluster has been computed).
                          </div>
                      </div>
                  </div>
                  <div class="col">
                      <div class="card no-box-shadow h-100">
                          <div class="card-header card-title">
                              4. Conservation threshold
                          </div>
                          <div class="card-body">
                              Genes are colored by functional terms. However,
                              to better assess functional conservation, these
                              terms can be filtered by vertical conservation. 
                              <div class="text-muted">
                                  Vertical conservation = ( genomes with functional term in neighborhood ) / total genomes
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          {% comment %}<div class="tab-pane fade" id="gcv-legend" role="tabpanel" aria-labelledby="contact-tab">{% endcomment %}
              {% comment %}...{% endcomment %}
          {% comment %}</div>{% endcomment %}
      </div>
    </div>
</div>


{% endblock %}
